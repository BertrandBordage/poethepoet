<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Tasks" href="../tasks/index.html" /><link rel="prev" title="Composing tasks" href="composing_tasks.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Load tasks from another file - Poe the Poet</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Poe the Poet</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/poe_logo_x2000.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/poe_logo_x2000.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Poe the Poet</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/basic_usage.html">Basic Usage</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="composing_tasks.html">Composing tasks</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Load tasks from another file</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tasks/index.html">Tasks</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tasks/types_of_tasks/cmd.html">“cmd” tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tasks/types_of_tasks/expr.html">“expr” tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tasks/types_of_tasks/ref.html">“ref” tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tasks/types_of_tasks/script.html">“script” tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tasks/types_of_tasks/sequence.html">“sequence” tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tasks/types_of_tasks/shell.html">“shell” tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tasks/types_of_tasks/switch.html">“switch” tasks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../configuration/index.html">Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration/project-wide_configuration.html">Project-wide configuration options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/task_level_configuration.html">Task level configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html#licence">Licence</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="load-tasks-from-another-file">
<h1>Load tasks from another file<a class="headerlink" href="#load-tasks-from-another-file" title="Permalink to this heading">#</a></h1>
<p>There are some scenarios where one might wish to define tasks outside of pyproject.toml,
or to collect tasks from multiple projects into one. For example, if you want to share
tasks between projects via git modules, generate tasks definitions dynamically, organise
your code in a monorepo, or simply have a lot of tasks and don’t want the pyproject.toml
to get too large. This can be achieved by creating a toml or json including the same
structure for tasks as used in pyproject.toml</p>
<p>For example:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="c1"># acme_common/shared_tasks.toml</span>
<span class="k">[tool.poe.tasks.build-image]</span>
<span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;docker build&quot;</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe]</span>
<span class="c1"># this references a file from a git submodule</span>
<span class="n">include</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;modules/acme_common/shared_tasks.toml&quot;</span>
</pre></div>
</div>
<p>Imported files may also specify environment variables via
<code class="code docutils literal notranslate"><span class="pre">tool.poe.envfile</span></code> or entries for <code class="code docutils literal notranslate"><span class="pre">tool.poe.env</span></code>.</p>
<p>It’s also possible to include tasks from multiple files by providing a list like
so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe]</span>
<span class="n">include</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;modules/acme_common/shared_tasks.toml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;generated_tasks.json&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Files are loaded in the order specified. If an item already exists then the included
value it ignored.</p>
<p>If an included task file itself includes other files, these second order includes are
not inherited, so circular includes don’t cause any problems.</p>
<p>When including files from another location, you can also specify that tasks from that
other file should be run from within a specific directory. For example with the
following configuration, when tasks imported from my_subproject are run
from the root, the task will actually execute as if it had been run from the
my_subproject subdirectory.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[[tool.poe.include]]</span>
<span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;my_subproject/pyproject.toml&quot;</span>
<span class="n">cwd</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;my_subproject&quot;</span>
</pre></div>
</div>
<p>The cwd option still has the limitation that it cannot be used to specify a directory
outside of parent directory of the pyproject.toml file that poe is running with.</p>
<p>If a referenced file is missing then poe ignores it without error, though
failure to read the contents will result in failure.</p>
<section id="configuring-the-plugin">
<h2>Configuring the plugin<a class="headerlink" href="#configuring-the-plugin" title="Permalink to this heading">#</a></h2>
<p>By default the poetry plugin will register <em>poe</em> as a command prefix so tasks can be
invoked like:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>poe<span class="w"> </span><span class="o">[</span>task_name<span class="o">]</span><span class="w"> </span><span class="o">[</span>task_args<span class="o">]</span>
</pre></div>
</div>
<p>And the poe documentation can be viewed via:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>poe
</pre></div>
</div>
<p>It is also possible to modify this behavoir, to either have a different command prefix
or none at all by setting the <code class="code highlight toml docutils literal highlight-toml"><span class="n">poetry_command</span></code> global option in your
pyproject.toml like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe]</span>
<span class="n">poetry_command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</pre></div>
</div>
<p>In this case poe tasks will be registered as top level commands on poetry and can be
invoked simply as:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span><span class="o">[</span>task_name<span class="o">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Whatever <code class="code highlight toml docutils literal highlight-toml"><span class="n">tool</span><span class="p">.</span><span class="n">poe</span><span class="p">.</span><span class="n">poetry_command</span></code> is set to must not already exist as a
poetry command!</p>
<p>Additionally if setting it to the emtpy string then care must be taken to avoid
defining any poe tasks that conflict with any other built in or plugin provided
poetry command.</p>
</div>
</section>
<section id="hooking-into-poetry-commands">
<h2>Hooking into poetry commands<a class="headerlink" href="#hooking-into-poetry-commands" title="Permalink to this heading">#</a></h2>
<p>It is also possible to configure a task to be run before or after a specific poetry
command by declaring the poetry_hooks global option like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.poetry_hooks]</span>
<span class="n">pre_build</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;prep-assets --verbosity=5&quot;</span>
<span class="n">post_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;archive-build&quot;</span>

<span class="k">[tool.poe.tasks.prep-assets]</span>
<span class="n">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;scripts:prepare_assets&quot;</span>
<span class="n">help</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Optimise static assets for inclusion in the build&quot;</span>

<span class="k">[tool.poe.tasks.archive-build]</span>
<span class="n">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;scripts:archive_build&quot;</span>
<span class="n">help</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Upload the latest build version to archive server&quot;</span>
</pre></div>
</div>
<p>In this example the <code class="code docutils literal notranslate"><span class="pre">prep-assets</span></code> task will be run as the first step in calling
<code class="code highlight bash docutils literal highlight-bash">poetry<span class="w"> </span>build</code> with an argument passed as if the task were being called via the
poe CLI. We’ve also configured the <code class="code docutils literal notranslate"><span class="pre">archive-build</span></code> task to be run after every
successful build.</p>
<p>If a task fails when running as a hook, then the poetry command will exit with an error.
If it is a <em>pre</em> hook then this will cause the actual poetry command not to execute.
This behaviour may be useful for running checks before <code class="code highlight bash docutils literal highlight-bash">poetry<span class="w"> </span>publish</code></p>
<p>Hooks can be disabled for a single invocation by passing the <code class="code highlight bash docutils literal highlight-bash">--no-plugins</code> option
to poetry.</p>
<p>Namespaced commands like <code class="code highlight bash docutils literal highlight-bash">poetry<span class="w"> </span>env<span class="w"> </span>info</code> can be specified with underscores like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.poetry_hooks]</span>
<span class="n">post_env_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;info&quot;</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../tasks/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tasks</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="composing_tasks.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Composing tasks</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Nat Noordanus
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Load tasks from another file</a><ul>
<li><a class="reference internal" href="#configuring-the-plugin">Configuring the plugin</a></li>
<li><a class="reference internal" href="#hooking-into-poetry-commands">Hooking into poetry commands</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>